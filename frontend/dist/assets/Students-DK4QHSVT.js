import{u as D,j as e}from"./index-67lOYeQn.js";import{r as i}from"./vendor-CytKP1XG.js";import{A as q,m as f,h as I,X as G,U as _,s as O,t as ee,E as se,u as V,K as A,F as J,N as F,O as K,J as ae,T as W,j as re,g as U,a0 as H,a1 as te,I as z,l as M,W as le,D as ie,S as ne,Q as ce,Y as de,_ as oe,e as me,d as xe}from"./ui-B9NvKoMF.js";import"./router-RO4D7ex0.js";import"./charts-DqeNaFAB.js";const ue=({isOpen:u,onClose:h,onSuccess:o})=>{const{token:n}=D(),[E,k]=i.useState(!1),[C,m]=i.useState(null),[c,d]=i.useState(!1),[l,b]=i.useState({email:"",password:"",firstName:"",lastName:"",parentEmail:"",skillLevel:"beginner",primaryGoals:[],notes:""}),[N,j]=i.useState("");i.useEffect(()=>{u&&(b({email:"",password:"",firstName:"",lastName:"",parentEmail:"",skillLevel:"beginner",primaryGoals:[],notes:""}),j(""),m(null),d(!1))},[u]);const p=(r,g)=>{b(y=>({...y,[r]:g}))},S=()=>{N.trim()&&!l.primaryGoals.includes(N.trim())&&(b(r=>({...r,primaryGoals:[...r.primaryGoals,N.trim()]})),j(""))},w=r=>{b(g=>({...g,primaryGoals:g.primaryGoals.filter(y=>y!==r)}))},a=()=>{const r="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let g="";for(let y=0;y<8;y++)g+=r.charAt(Math.floor(Math.random()*r.length));p("password",g)},s=r=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r),x=async r=>{var g;if(r.preventDefault(),!!n){if(!l.firstName.trim()){m("El nombre es requerido");return}if(!l.lastName.trim()){m("El apellido es requerido");return}if(!l.email.trim()){m("El email es requerido");return}if(!s(l.email)){m("El email no es válido");return}if(!l.parentEmail.trim()){m("El email del padre es requerido");return}if(!s(l.parentEmail)){m("El email del padre no es válido");return}if(!l.password||l.password.length<6){m("La contraseña debe tener al menos 6 caracteres");return}if(l.primaryGoals.length===0){m("Agrega al menos un objetivo principal");return}try{k(!0),m(null);const y=await fetch("/api/students",{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify(l)});if(y.ok)o(),h();else{const P=await y.json();m(((g=P.error)==null?void 0:g.message)||"Error al crear el estudiante")}}catch{m("Error de conexión")}finally{k(!1)}}};return e.jsx(q,{children:u&&e.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[e.jsx(f.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:h}),e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs(f.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(I,{className:"h-6 w-6 text-blue-600 mr-3"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Nuevo Estudiante"})]}),e.jsx("button",{onClick:h,className:"text-gray-400 hover:text-gray-500 p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(G,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:x,className:"p-6 space-y-6",children:[C&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-red-800 text-sm",children:C})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[e.jsx(_,{className:"h-5 w-5 mr-2"}),"Información Personal"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre *"}),e.jsx("input",{type:"text",value:l.firstName,onChange:r=>p("firstName",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Nombre del estudiante",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Apellido *"}),e.jsx("input",{type:"text",value:l.lastName,onChange:r=>p("lastName",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Apellido del estudiante",required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(O,{className:"h-4 w-4 inline mr-1"}),"Email del Estudiante *"]}),e.jsx("input",{type:"email",value:l.email,onChange:r=>p("email",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"email@estudiante.com",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(O,{className:"h-4 w-4 inline mr-1"}),"Email del Padre/Tutor *"]}),e.jsx("input",{type:"email",value:l.parentEmail,onChange:r=>p("parentEmail",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"email@padre.com",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(ee,{className:"h-4 w-4 inline mr-1"}),"Contraseña *"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:c?"text":"password",value:l.password,onChange:r=>p("password",r.target.value),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Contraseña (mín. 6 caracteres)",required:!0}),e.jsx("button",{type:"button",onClick:()=>d(!c),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:c?e.jsx(se,{className:"h-4 w-4"}):e.jsx(V,{className:"h-4 w-4"})})]}),e.jsx("button",{type:"button",onClick:a,className:"px-3 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:"Generar"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Información Académica"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nivel de Habilidad"}),e.jsxs("select",{value:l.skillLevel,onChange:r=>p("skillLevel",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"beginner",children:"Principiante"}),e.jsx("option",{value:"intermediate",children:"Intermedio"}),e.jsx("option",{value:"advanced",children:"Avanzado"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(A,{className:"h-4 w-4 inline mr-1"}),"Objetivos Principales *"]}),e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsx("input",{type:"text",value:N,onChange:r=>j(r.target.value),onKeyPress:r=>r.key==="Enter"&&(r.preventDefault(),S()),placeholder:"Escribir objetivo y presionar Enter",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsx("button",{type:"button",onClick:S,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Agregar"})]}),l.primaryGoals.length>0&&e.jsx("div",{className:"space-y-2",children:l.primaryGoals.map((r,g)=>e.jsxs("div",{className:"flex items-center justify-between bg-blue-50 px-3 py-2 rounded-lg",children:[e.jsx("span",{className:"text-sm text-blue-900",children:r}),e.jsx("button",{type:"button",onClick:()=>w(r),className:"text-blue-600 hover:text-blue-800 p-1",children:e.jsx(G,{className:"h-4 w-4"})})]},g))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(J,{className:"h-4 w-4 inline mr-1"}),"Notas Adicionales"]}),e.jsx("textarea",{value:l.notes,onChange:r=>p("notes",r.target.value),rows:3,placeholder:"Información adicional sobre el estudiante (opcional)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:h,className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:E,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2",children:E?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"h-4 w-4 animate-spin"}),"Creando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"h-4 w-4"}),"Crear Estudiante"]})})]})]})]})})]})})},he=({isOpen:u,onClose:h,onSuccess:o,student:n})=>{const{token:E}=D(),[k,C]=i.useState(!1),[m,c]=i.useState(null),[d,l]=i.useState({firstName:"",lastName:"",parentEmail:"",skillLevel:"beginner",primaryGoals:[],notes:""}),[b,N]=i.useState("");i.useEffect(()=>{u&&n&&(l({firstName:n.firstName,lastName:n.lastName,parentEmail:n.child.parentEmail,skillLevel:n.child.skillLevel,primaryGoals:[...n.child.primaryGoals],notes:n.child.notes||""}),N(""),c(null))},[u,n]);const j=(s,x)=>{l(r=>({...r,[s]:x}))},p=()=>{b.trim()&&!d.primaryGoals.includes(b.trim())&&(l(s=>({...s,primaryGoals:[...s.primaryGoals,b.trim()]})),N(""))},S=s=>{l(x=>({...x,primaryGoals:x.primaryGoals.filter(r=>r!==s)}))},w=s=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s),a=async s=>{var x;if(s.preventDefault(),!(!E||!n)){if(!d.firstName.trim()){c("El nombre es requerido");return}if(!d.lastName.trim()){c("El apellido es requerido");return}if(!d.parentEmail.trim()){c("El email del padre es requerido");return}if(!w(d.parentEmail)){c("El email del padre no es válido");return}if(d.primaryGoals.length===0){c("Agrega al menos un objetivo principal");return}try{C(!0),c(null);const r=await fetch(`/api/students/${n._id}`,{method:"PUT",headers:{Authorization:`Bearer ${E}`,"Content-Type":"application/json"},body:JSON.stringify(d)});if(r.ok)o(),h();else{const g=await r.json();c(((x=g.error)==null?void 0:x.message)||"Error al actualizar el estudiante")}}catch{c("Error de conexión")}finally{C(!1)}}};return n?e.jsx(q,{children:u&&e.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[e.jsx(f.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:h}),e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs(f.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(I,{className:"h-6 w-6 text-blue-600 mr-3"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Editar Estudiante"}),e.jsxs("p",{className:"text-sm text-gray-500",children:[n.firstName," ",n.lastName," (",n.email,")"]})]})]}),e.jsx("button",{onClick:h,className:"text-gray-400 hover:text-gray-500 p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(G,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:a,className:"p-6 space-y-6",children:[m&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-red-800 text-sm flex items-center",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),m]})}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Información del Sistema"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Email:"}),e.jsx("p",{className:"font-medium",children:n.email})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Sesiones completadas:"}),e.jsx("p",{className:"font-medium",children:n.child.sessionsCompleted})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Tiempo total:"}),e.jsxs("p",{className:"font-medium",children:[Math.round(n.child.totalSessionTime/60)," horas"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Email del padre:"}),e.jsx("p",{className:"font-medium",children:n.child.parentEmail})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[e.jsx(_,{className:"h-5 w-5 mr-2"}),"Información Personal"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre *"}),e.jsx("input",{type:"text",value:d.firstName,onChange:s=>j("firstName",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Nombre del estudiante",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Apellido *"}),e.jsx("input",{type:"text",value:d.lastName,onChange:s=>j("lastName",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Apellido del estudiante",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email del Padre/Tutor *"}),e.jsx("input",{type:"email",value:d.parentEmail,onChange:s=>j("parentEmail",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"email@padre.com",required:!0})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Información Académica"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nivel de Habilidad"}),e.jsxs("select",{value:d.skillLevel,onChange:s=>j("skillLevel",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"beginner",children:"Principiante"}),e.jsx("option",{value:"intermediate",children:"Intermedio"}),e.jsx("option",{value:"advanced",children:"Avanzado"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(A,{className:"h-4 w-4 inline mr-1"}),"Objetivos Principales *"]}),e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsx("input",{type:"text",value:b,onChange:s=>N(s.target.value),onKeyPress:s=>s.key==="Enter"&&(s.preventDefault(),p()),placeholder:"Escribir objetivo y presionar Enter",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsx("button",{type:"button",onClick:p,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Agregar"})]}),d.primaryGoals.length>0&&e.jsx("div",{className:"space-y-2",children:d.primaryGoals.map((s,x)=>e.jsxs("div",{className:"flex items-center justify-between bg-blue-50 px-3 py-2 rounded-lg",children:[e.jsx("span",{className:"text-sm text-blue-900",children:s}),e.jsx("button",{type:"button",onClick:()=>S(s),className:"text-blue-600 hover:text-blue-800 p-1",children:e.jsx(G,{className:"h-4 w-4"})})]},x))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(J,{className:"h-4 w-4 inline mr-1"}),"Notas Adicionales"]}),e.jsx("textarea",{value:d.notes,onChange:s=>j("notes",s.target.value),rows:3,placeholder:"Información adicional sobre el estudiante",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:h,className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:k,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2",children:k?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"h-4 w-4 animate-spin"}),"Guardando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"h-4 w-4"}),"Guardar Cambios"]})})]})]})]})})]})}):null},ge=({isOpen:u,onClose:h,student:o})=>{const{token:n}=D(),[E,k]=i.useState(!1),[C,m]=i.useState(null),[c,d]=i.useState(null),[l,b]=i.useState("overview");i.useEffect(()=>{u&&o&&n&&N()},[u,o,n]);const N=async()=>{var a;if(!(!o||!n))try{k(!0),m(null);const s=await fetch(`/api/students/${o._id}/progress`,{headers:{Authorization:`Bearer ${n}`}});if(s.ok){const x=await s.json();d(x.data)}else{const x=await s.json();m(((a=x.error)==null?void 0:a.message)||"Error al cargar el progreso")}}catch{m("Error de conexión")}finally{k(!1)}},j=a=>new Date(a).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}),p=a=>{const s=Math.floor(a/60),x=a%60;return s>0?`${s}h ${x}m`:`${x}m`},S=a=>{switch(a){case"beginner":return"bg-yellow-100 text-yellow-800";case"intermediate":return"bg-blue-100 text-blue-800";case"advanced":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},w=a=>{switch(a){case"beginner":return"Principiante";case"intermediate":return"Intermedio";case"advanced":return"Avanzado";default:return a}};return o?e.jsx(q,{children:u&&e.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[e.jsx(f.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:h}),e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs(f.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(W,{className:"h-6 w-6 text-blue-600 mr-3"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Progreso del Estudiante"}),e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[e.jsxs("p",{className:"text-sm text-gray-500",children:[o.firstName," ",o.lastName]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${S(o.child.skillLevel)}`,children:w(o.child.skillLevel)})]})]})]}),e.jsx("button",{onClick:h,className:"text-gray-400 hover:text-gray-500 p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(G,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex space-x-8 px-6",children:[{id:"overview",label:"Resumen",icon:re},{id:"sessions",label:"Sesiones",icon:U},{id:"goals",label:"Objetivos",icon:A},{id:"skills",label:"Habilidades",icon:H}].map(a=>e.jsxs("button",{onClick:()=>b(a.id),className:`py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2 transition-colors ${l===a.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(a.icon,{className:"h-4 w-4"}),a.label]},a.id))})}),e.jsx("div",{className:"p-6",children:E?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(F,{className:"h-8 w-8 animate-spin text-blue-600"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Cargando progreso..."})]}):C?e.jsxs("div",{className:"flex items-center justify-center py-12 text-red-600",children:[e.jsx(te,{className:"h-8 w-8 mr-3"}),e.jsx("span",{children:C})]}):c?e.jsxs(e.Fragment,{children:[l==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(U,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-blue-900",children:"Sesiones"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:o.child.sessionsCompleted})]})]})}),e.jsx("div",{className:"bg-green-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-green-900",children:"Tiempo Total"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:p(o.child.totalSessionTime)})]})]})}),e.jsx("div",{className:"bg-purple-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(M,{className:"h-8 w-8 text-purple-600"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-purple-900",children:"Precisión"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:"0%"})]})]})}),e.jsx("div",{className:"bg-orange-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(A,{className:"h-8 w-8 text-orange-600"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-orange-900",children:"Objetivos"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:o.child.primaryGoals.length})]})]})})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Progreso Semanal"}),c.weeklyProgress.length>0?e.jsx("div",{className:"space-y-3",children:c.weeklyProgress.slice(-4).map((a,s)=>e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:a.week}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("span",{className:"text-blue-600",children:[a.sessionsCompleted," sesiones"]}),e.jsx("span",{className:"text-green-600",children:p(a.totalTime)}),e.jsxs("span",{className:"text-purple-600",children:[a.averageAccuracy,"% precisión"]})]})]},s))}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No hay datos de progreso semanal disponibles"})]})]}),l==="sessions"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Sesiones Recientes"}),c.recentSessions.length>0?e.jsx("div",{className:"space-y-3",children:c.recentSessions.map(a=>e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-900",children:["Sesión - ",j(a.date)]}),e.jsxs("div",{className:"flex items-center gap-4 mt-1 text-sm text-gray-600",children:[e.jsxs("span",{children:[e.jsx(z,{className:"h-4 w-4 inline mr-1"}),p(a.duration)]}),e.jsxs("span",{children:[e.jsx(M,{className:"h-4 w-4 inline mr-1"}),a.accuracy,"%"]}),e.jsxs("span",{children:[e.jsx(H,{className:"h-4 w-4 inline mr-1"}),a.gamesPlayed," juegos"]})]})]}),e.jsx("div",{className:"text-right",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${a.status==="completed"?"bg-green-100 text-green-800":a.status==="scheduled"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:a.status==="completed"?"Completada":a.status==="scheduled"?"Programada":a.status})})]})},a._id))}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No hay sesiones recientes disponibles"})]}),l==="goals"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Progreso de Objetivos"}),c.goalProgress.length>0?e.jsx("div",{className:"space-y-4",children:c.goalProgress.map((a,s)=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:a.goal}),e.jsxs("span",{className:"text-sm font-medium text-blue-600",children:[a.completionPercentage,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${a.completionPercentage}%`}})}),e.jsxs("p",{className:"text-sm text-gray-600",children:[a.sessionsWorked," sesiones trabajadas en este objetivo"]})]},s))}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No hay datos de progreso de objetivos disponibles"})]}),l==="skills"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Mejoras en Habilidades"}),c.skillImprovements.length>0?e.jsx("div",{className:"space-y-4",children:c.skillImprovements.map((a,s)=>e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:a.skill}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:[a.previousLevel,"% → ",a.currentLevel,"%"]}),e.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${a.improvement>0?"bg-green-100 text-green-800":a.improvement<0?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:[a.improvement>0?"+":"",a.improvement,"%"]})]})]})},s))}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No hay datos de mejoras en habilidades disponibles"})]})]}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"No hay datos de progreso disponibles"})})}),e.jsx("div",{className:"flex justify-end p-6 border-t border-gray-200",children:e.jsx("button",{onClick:h,className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"Cerrar"})})]})})]})}):null},Ne=()=>{const{user:u,token:h}=D(),[o,n]=i.useState([]),[E,k]=i.useState([]),[C,m]=i.useState(!0),[c,d]=i.useState(null),[l,b]=i.useState(!1),[N,j]=i.useState(null),[p,S]=i.useState(null),[w,a]=i.useState("all"),[s,x]=i.useState(""),[r,g]=i.useState(1),[y]=i.useState(10),P=async()=>{if(h)try{m(!0);const t=await fetch("/api/students",{headers:{Authorization:`Bearer ${h}`,"Content-Type":"application/json"}});if(t.ok){const v=await t.json();n(v.data.students||[])}else d("Error al cargar los estudiantes")}catch{d("Error de conexión")}finally{m(!1)}};i.useEffect(()=>{let t=o;w!=="all"&&(t=t.filter(v=>v.child.skillLevel===w)),s&&(t=t.filter(v=>v.firstName.toLowerCase().includes(s.toLowerCase())||v.lastName.toLowerCase().includes(s.toLowerCase())||v.email.toLowerCase().includes(s.toLowerCase())||v.child.parentEmail.toLowerCase().includes(s.toLowerCase()))),k(t),g(1)},[o,w,s]),i.useEffect(()=>{(u==null?void 0:u.role)==="slp"&&P()},[h,u]);const R=(r-1)*y,Q=R+y,B=E.slice(R,Q),T=Math.ceil(E.length/y),X=async t=>{var v;if(!(!h||!confirm("¿Estás seguro de que quieres eliminar este estudiante?")))try{const L=await fetch(`/api/students/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${h}`,"Content-Type":"application/json"}});if(L.ok)P();else{const $=await L.json();d(((v=$.error)==null?void 0:v.message)||"Error al eliminar el estudiante")}}catch{d("Error de conexión")}},Y=t=>{switch(t){case"beginner":return"bg-yellow-100 text-yellow-800";case"intermediate":return"bg-blue-100 text-blue-800";case"advanced":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},Z=t=>{switch(t){case"beginner":return"Principiante";case"intermediate":return"Intermedio";case"advanced":return"Avanzado";default:return t}};return(u==null?void 0:u.role)!=="slp"?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(le,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Acceso Restringido"}),e.jsx("p",{className:"text-gray-600",children:"Solo los terapeutas pueden acceder a la gestión de estudiantes"})]})}):C?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Cargando estudiantes..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx(f.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Gestión de Estudiantes"}),e.jsx("p",{className:"text-gray-600",children:"Administra tu caseload de estudiantes"})]}),e.jsxs(f.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>b(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg flex items-center gap-2 transition-colors duration-200",children:[e.jsx(ie,{className:"h-5 w-5"}),"Nuevo Estudiante"]})]})}),e.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Estudiantes"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.length})]}),e.jsx(I,{className:"h-8 w-8 text-blue-600"})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Principiantes"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.filter(t=>t.child.skillLevel==="beginner").length})]}),e.jsx(M,{className:"h-8 w-8 text-yellow-600"})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Intermedios"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.filter(t=>t.child.skillLevel==="intermediate").length})]}),e.jsx(W,{className:"h-8 w-8 text-blue-600"})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Avanzados"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.filter(t=>t.child.skillLevel==="advanced").length})]}),e.jsx(A,{className:"h-8 w-8 text-green-600"})]})})]}),e.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-xl shadow-sm p-6 mb-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(ne,{className:"h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar por nombre, email o email del padre...",value:s,onChange:t=>x(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-5 w-5 text-gray-400"}),e.jsxs("select",{value:w,onChange:t=>a(t.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"Todos los niveles"}),e.jsx("option",{value:"beginner",children:"Principiante"}),e.jsx("option",{value:"intermediate",children:"Intermedio"}),e.jsx("option",{value:"advanced",children:"Avanzado"})]})]})]})}),c&&e.jsxs(f.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:[e.jsx("p",{className:"text-red-800",children:c}),e.jsx("button",{onClick:()=>d(null),className:"mt-2 text-sm text-red-600 underline",children:"Cerrar"})]}),e.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white rounded-xl shadow-sm overflow-hidden",children:B.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(I,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay estudiantes"}),e.jsx("p",{className:"text-gray-600",children:s||w!=="all"?"No se encontraron estudiantes con los filtros aplicados":"Aún no has agregado ningún estudiante a tu caseload"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-gray-50 px-6 py-3 border-b border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-6 gap-4 text-sm font-medium text-gray-500 uppercase tracking-wider",children:[e.jsx("div",{children:"Estudiante"}),e.jsx("div",{children:"Email del Padre"}),e.jsx("div",{children:"Nivel"}),e.jsx("div",{children:"Sesiones"}),e.jsx("div",{children:"Tiempo Total"}),e.jsx("div",{children:"Acciones"})]})}),e.jsx("div",{className:"divide-y divide-gray-200",children:e.jsx(q,{children:B.map((t,v)=>e.jsxs(f.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{delay:v*.05},className:"px-6 py-4 hover:bg-gray-50 transition-colors duration-150",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-6 gap-4 items-center",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-10 w-10 bg-blue-100 rounded-full flex items-center justify-center mr-3",children:e.jsxs("span",{className:"text-sm font-medium text-blue-600",children:[t.firstName[0],t.lastName[0]]})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[t.firstName," ",t.lastName]}),e.jsx("p",{className:"text-sm text-gray-500",children:t.email})]})]}),e.jsx("div",{children:e.jsx("p",{className:"text-sm text-gray-900",children:t.child.parentEmail})}),e.jsx("div",{children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${Y(t.child.skillLevel)}`,children:Z(t.child.skillLevel)})}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{className:"h-4 w-4 text-gray-400 mr-1"}),e.jsx("p",{className:"text-sm text-gray-900",children:t.child.sessionsCompleted})]})}),e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-900",children:[Math.round(t.child.totalSessionTime)," min"]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>S(t),className:"p-2 text-green-600 hover:bg-green-100 rounded-lg transition-colors duration-150",title:"Ver progreso",children:e.jsx(V,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>j(t),className:"p-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors duration-150",title:"Editar estudiante",children:e.jsx(de,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>X(t._id),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors duration-150",title:"Eliminar estudiante",children:e.jsx(oe,{className:"h-4 w-4"})})]})]}),t.child.primaryGoals&&t.child.primaryGoals.length>0&&e.jsx("div",{className:"mt-3 lg:col-span-6",children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[t.child.primaryGoals.slice(0,3).map((L,$)=>e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-indigo-100 text-indigo-800",children:L},$)),t.child.primaryGoals.length>3&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-gray-100 text-gray-800",children:["+",t.child.primaryGoals.length-3," más"]})]})})]},t._id))})})]})}),T>1&&e.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"mt-6 flex justify-center",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>g(Math.max(1,r-1)),disabled:r===1,className:"p-2 rounded-lg border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:e.jsx(me,{className:"h-4 w-4"})}),e.jsxs("span",{className:"px-4 py-2 text-sm text-gray-700",children:["Página ",r," de ",T]}),e.jsx("button",{onClick:()=>g(Math.min(T,r+1)),disabled:r===T,className:"p-2 rounded-lg border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:e.jsx(xe,{className:"h-4 w-4"})})]})})]}),e.jsx(ue,{isOpen:l,onClose:()=>b(!1),onSuccess:()=>{P(),b(!1)}}),e.jsx(he,{isOpen:!!N,onClose:()=>j(null),onSuccess:()=>{P(),j(null)},student:N}),e.jsx(ge,{isOpen:!!p,onClose:()=>S(null),student:p})]})};export{Ne as default};
//# sourceMappingURL=Students-DK4QHSVT.js.map
