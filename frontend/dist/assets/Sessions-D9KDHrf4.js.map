{"version":3,"file":"Sessions-D9KDHrf4.js","sources":["../../src/components/modals/EditSessionModal.tsx","../../src/pages/Sessions.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport {\r\n  X,\r\n  Calendar,\r\n  Clock,\r\n  Users,\r\n  Target,\r\n  FileText,\r\n  Save,\r\n  Loader2,\r\n  AlertTriangle\r\n} from 'lucide-react';\r\nimport { useAuthStore } from '../../store/authStore';\r\n\r\n// Tipos\r\ninterface Session {\r\n  _id: string;\r\n  childId: {\r\n    _id: string;\r\n    firstName: string;\r\n    lastName: string;\r\n  };\r\n  slpId: {\r\n    _id: string;\r\n    firstName: string;\r\n    lastName: string;\r\n  };\r\n  scheduledDate: string;\r\n  startTime?: string;\r\n  endTime?: string;\r\n  duration?: number;\r\n  status: 'scheduled' | 'in_progress' | 'completed' | 'cancelled';\r\n  sessionType: 'therapy' | 'evaluation' | 'game';\r\n  notes?: string;\r\n  goals?: string[];\r\n  gamesPlayed?: number;\r\n  accuracy?: number;\r\n}\r\n\r\ninterface EditSessionData {\r\n  scheduledDate: string;\r\n  duration: number;\r\n  sessionType: 'therapy' | 'evaluation' | 'game';\r\n  notes?: string;\r\n  goals?: string[];\r\n}\r\n\r\ninterface EditSessionModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onSuccess: () => void;\r\n  session: Session | null;\r\n}\r\n\r\nconst EditSessionModal: React.FC<EditSessionModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  onSuccess,\r\n  session\r\n}) => {\r\n  const { token } = useAuthStore();\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  \r\n  // Datos del formulario\r\n  const [formData, setFormData] = useState<EditSessionData>({\r\n    scheduledDate: '',\r\n    duration: 45,\r\n    sessionType: 'therapy',\r\n    notes: '',\r\n    goals: []\r\n  });\r\n\r\n  const [goalInput, setGoalInput] = useState('');\r\n\r\n  // Cargar datos de la sesión cuando se abre el modal\r\n  useEffect(() => {\r\n    if (isOpen && session) {\r\n      setFormData({\r\n        scheduledDate: session.scheduledDate.split('T')[0],\r\n        duration: session.duration || 45,\r\n        sessionType: session.sessionType,\r\n        notes: session.notes || '',\r\n        goals: [...(session.goals || [])]\r\n      });\r\n      setGoalInput('');\r\n      setError(null);\r\n    }\r\n  }, [isOpen, session]);\r\n\r\n  // Manejar cambios en el formulario\r\n  const handleInputChange = (field: keyof EditSessionData, value: any) => {\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      [field]: value\r\n    }));\r\n  };\r\n\r\n  // Agregar objetivo\r\n  const addGoal = () => {\r\n    if (goalInput.trim() && !formData.goals!.includes(goalInput.trim())) {\r\n      setFormData(prev => ({\r\n        ...prev,\r\n        goals: [...(prev.goals || []), goalInput.trim()]\r\n      }));\r\n      setGoalInput('');\r\n    }\r\n  };\r\n\r\n  // Remover objetivo\r\n  const removeGoal = (goalToRemove: string) => {\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      goals: prev.goals!.filter(goal => goal !== goalToRemove)\r\n    }));\r\n  };\r\n\r\n  // Enviar formulario\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!token || !session) return;\r\n\r\n    // Validaciones\r\n    if (!formData.scheduledDate) {\r\n      setError('Debes seleccionar una fecha');\r\n      return;\r\n    }\r\n\r\n    if (formData.duration < 15 || formData.duration > 180) {\r\n      setError('La duración debe estar entre 15 y 180 minutos');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n\r\n      const response = await fetch(`/api/sessions/${session._id}`, {\r\n        method: 'PUT',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify(formData)\r\n      });\r\n\r\n      if (response.ok) {\r\n        onSuccess();\r\n        onClose();\r\n      } else {\r\n        const errorData = await response.json();\r\n        setError(errorData.error?.message || 'Error al actualizar la sesión');\r\n      }\r\n    } catch (err) {\r\n      setError('Error de conexión');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  if (!session) return null;\r\n\r\n  return (\r\n    <AnimatePresence>\r\n      {isOpen && (\r\n        <div className=\"fixed inset-0 z-50 overflow-y-auto\">\r\n          {/* Overlay */}\r\n          <motion.div\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            exit={{ opacity: 0 }}\r\n            className=\"fixed inset-0 bg-black bg-opacity-50 transition-opacity\"\r\n            onClick={onClose}\r\n          />\r\n\r\n          {/* Modal */}\r\n          <div className=\"flex min-h-full items-center justify-center p-4\">\r\n            <motion.div\r\n              initial={{ opacity: 0, scale: 0.95 }}\r\n              animate={{ opacity: 1, scale: 1 }}\r\n              exit={{ opacity: 0, scale: 0.95 }}\r\n              className=\"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto\"\r\n            >\r\n              {/* Header */}\r\n              <div className=\"flex items-center justify-between p-6 border-b border-gray-200\">\r\n                <div className=\"flex items-center\">\r\n                  <Calendar className=\"h-6 w-6 text-blue-600 mr-3\" />\r\n                  <div>\r\n                    <h2 className=\"text-xl font-semibold text-gray-900\">\r\n                      Editar Sesión\r\n                    </h2>\r\n                    <p className=\"text-sm text-gray-500\">\r\n                      {session.childId.firstName} {session.childId.lastName}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n                <button\r\n                  onClick={onClose}\r\n                  className=\"text-gray-400 hover:text-gray-500 p-2 hover:bg-gray-100 rounded-lg transition-colors\"\r\n                >\r\n                  <X className=\"h-5 w-5\" />\r\n                </button>\r\n              </div>\r\n\r\n              {/* Contenido */}\r\n              <form onSubmit={handleSubmit} className=\"p-6 space-y-6\">\r\n                {/* Error */}\r\n                {error && (\r\n                  <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\r\n                    <p className=\"text-red-800 text-sm flex items-center\">\r\n                      <AlertTriangle className=\"h-4 w-4 mr-2\" />\r\n                      {error}\r\n                    </p>\r\n                  </div>\r\n                )}\r\n\r\n                {/* Información no editable */}\r\n                <div className=\"bg-gray-50 rounded-lg p-4\">\r\n                  <h3 className=\"text-sm font-medium text-gray-700 mb-2\">\r\n                    Información del Sistema\r\n                  </h3>\r\n                  <div className=\"grid grid-cols-2 gap-4 text-sm\">\r\n                    <div>\r\n                      <span className=\"text-gray-500\">Estudiante:</span>\r\n                      <p className=\"font-medium\">{session.childId.firstName} {session.childId.lastName}</p>\r\n                    </div>\r\n                    <div>\r\n                      <span className=\"text-gray-500\">Estado:</span>\r\n                      <p className=\"font-medium capitalize\">{session.status}</p>\r\n                    </div>\r\n                    <div>\r\n                      <span className=\"text-gray-500\">ID de Sesión:</span>\r\n                      <p className=\"font-medium text-xs\">{session._id}</p>\r\n                    </div>\r\n                    <div>\r\n                      <span className=\"text-gray-500\">Juegos jugados:</span>\r\n                      <p className=\"font-medium\">{session.gamesPlayed || 0}</p>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Información editable */}\r\n                <div className=\"space-y-4\">\r\n                  <h3 className=\"text-lg font-medium text-gray-900 flex items-center\">\r\n                    <Calendar className=\"h-5 w-5 mr-2\" />\r\n                    Detalles de la Sesión\r\n                  </h3>\r\n                  \r\n                  {/* Fecha y Duración */}\r\n                  <div className=\"grid grid-cols-2 gap-4\">\r\n                    <div>\r\n                      <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                        <Calendar className=\"h-4 w-4 inline mr-1\" />\r\n                        Fecha *\r\n                      </label>\r\n                      <input\r\n                        type=\"date\"\r\n                        value={formData.scheduledDate}\r\n                        onChange={(e) => handleInputChange('scheduledDate', e.target.value)}\r\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                        required\r\n                      />\r\n                    </div>\r\n\r\n                    <div>\r\n                      <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                        <Clock className=\"h-4 w-4 inline mr-1\" />\r\n                        Duración (minutos) *\r\n                      </label>\r\n                      <input\r\n                        type=\"number\"\r\n                        min=\"15\"\r\n                        max=\"180\"\r\n                        value={formData.duration}\r\n                        onChange={(e) => handleInputChange('duration', parseInt(e.target.value))}\r\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                        required\r\n                      />\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Tipo de Sesión */}\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                      Tipo de Sesión\r\n                    </label>\r\n                    <select\r\n                      value={formData.sessionType}\r\n                      onChange={(e) => handleInputChange('sessionType', e.target.value)}\r\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                    >\r\n                      <option value=\"therapy\">Terapia</option>\r\n                      <option value=\"evaluation\">Evaluación</option>\r\n                      <option value=\"game\">Juego</option>\r\n                    </select>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Objetivos */}\r\n                <div className=\"space-y-4\">\r\n                  <h3 className=\"text-lg font-medium text-gray-900\">\r\n                    <Target className=\"h-5 w-5 inline mr-2\" />\r\n                    Objetivos de la Sesión\r\n                  </h3>\r\n                  \r\n                  {/* Input para agregar objetivos */}\r\n                  <div className=\"flex gap-2\">\r\n                    <input\r\n                      type=\"text\"\r\n                      value={goalInput}\r\n                      onChange={(e) => setGoalInput(e.target.value)}\r\n                      onKeyPress={(e) => e.key === 'Enter' && (e.preventDefault(), addGoal())}\r\n                      placeholder=\"Escribir objetivo y presionar Enter\"\r\n                      className=\"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                    />\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={addGoal}\r\n                      className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"\r\n                    >\r\n                      Agregar\r\n                    </button>\r\n                  </div>\r\n\r\n                  {/* Lista de objetivos */}\r\n                  {formData.goals && formData.goals.length > 0 && (\r\n                    <div className=\"space-y-2\">\r\n                      {formData.goals.map((goal, index) => (\r\n                        <div\r\n                          key={index}\r\n                          className=\"flex items-center justify-between bg-blue-50 px-3 py-2 rounded-lg\"\r\n                        >\r\n                          <span className=\"text-sm text-blue-900\">{goal}</span>\r\n                          <button\r\n                            type=\"button\"\r\n                            onClick={() => removeGoal(goal)}\r\n                            className=\"text-blue-600 hover:text-blue-800 p-1\"\r\n                          >\r\n                            <X className=\"h-4 w-4\" />\r\n                          </button>\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n\r\n                {/* Notas */}\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                    <FileText className=\"h-4 w-4 inline mr-1\" />\r\n                    Notas Adicionales\r\n                  </label>\r\n                  <textarea\r\n                    value={formData.notes}\r\n                    onChange={(e) => handleInputChange('notes', e.target.value)}\r\n                    rows={3}\r\n                    placeholder=\"Notas o comentarios sobre la sesión\"\r\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none\"\r\n                  />\r\n                </div>\r\n\r\n                {/* Botones */}\r\n                <div className=\"flex justify-end gap-3 pt-4 border-t border-gray-200\">\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={onClose}\r\n                    className=\"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors\"\r\n                  >\r\n                    Cancelar\r\n                  </button>\r\n                  <button\r\n                    type=\"submit\"\r\n                    disabled={loading}\r\n                    className=\"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2\"\r\n                  >\r\n                    {loading ? (\r\n                      <>\r\n                        <Loader2 className=\"h-4 w-4 animate-spin\" />\r\n                        Guardando...\r\n                      </>\r\n                    ) : (\r\n                      <>\r\n                        <Save className=\"h-4 w-4\" />\r\n                        Guardar Cambios\r\n                      </>\r\n                    )}\r\n                  </button>\r\n                </div>\r\n              </form>\r\n            </motion.div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </AnimatePresence>\r\n  );\r\n};\r\n\r\nexport default EditSessionModal;\r\n","import React, { useState, useEffect } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport {\r\n  Calendar,\r\n  Clock,\r\n  Users,\r\n  Plus,\r\n  Edit,\r\n  Trash2,\r\n  Play,\r\n  Square,\r\n  Filter,\r\n  Search,\r\n  ChevronLeft,\r\n  ChevronRight,\r\n  UserCheck,\r\n  Activity\r\n} from 'lucide-react';\r\nimport { useAuthStore } from '../store/authStore';\r\nimport CreateSessionModal from '../components/modals/CreateSessionModal';\r\nimport EditSessionModal from '../components/modals/EditSessionModal';\r\n\r\n// Tipos\r\ninterface Session {\r\n  _id: string;\r\n  childId: {\r\n    _id: string;\r\n    firstName: string;\r\n    lastName: string;\r\n  };\r\n  slpId: {\r\n    _id: string;\r\n    firstName: string;\r\n    lastName: string;\r\n  };\r\n  scheduledDate: string;\r\n  startTime?: string;\r\n  endTime?: string;\r\n  duration?: number;\r\n  status: 'scheduled' | 'in_progress' | 'completed' | 'cancelled';\r\n  sessionType: 'therapy' | 'evaluation' | 'game';\r\n  notes?: string;\r\n  goals?: string[];\r\n  gamesPlayed?: number;\r\n  accuracy?: number;\r\n}\r\n\r\ninterface CreateSessionData {\r\n  childId: string;\r\n  scheduledDate: string;\r\n  duration: number;\r\n  sessionType: 'therapy' | 'evaluation' | 'game';\r\n  notes?: string;\r\n  goals?: string[];\r\n}\r\n\r\n// Componente principal\r\nconst Sessions: React.FC = () => {\r\n  const { user, token } = useAuthStore();\r\n  const [sessions, setSessions] = useState<Session[]>([]);\r\n  const [filteredSessions, setFilteredSessions] = useState<Session[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [showCreateModal, setShowCreateModal] = useState(false);\r\n  const [editingSession, setEditingSession] = useState<Session | null>(null);\r\n  \r\n  // Filtros y búsqueda\r\n  const [statusFilter, setStatusFilter] = useState<string>('all');\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [itemsPerPage] = useState(10);\r\n\r\n  // Cargar sesiones\r\n  const loadSessions = async () => {\r\n    if (!token) return;\r\n\r\n    try {\r\n      setLoading(true);\r\n      const response = await fetch('/api/sessions', {\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json'\r\n        }\r\n      });\r\n\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setSessions(data.data.sessions || []);\r\n      } else {\r\n        setError('Error al cargar las sesiones');\r\n      }\r\n    } catch (err) {\r\n      setError('Error de conexión');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Filtrar sesiones\r\n  useEffect(() => {\r\n    let filtered = sessions;\r\n\r\n    // Filtro por estado\r\n    if (statusFilter !== 'all') {\r\n      filtered = filtered.filter(session => session.status === statusFilter);\r\n    }\r\n\r\n    // Filtro por búsqueda\r\n    if (searchTerm) {\r\n      filtered = filtered.filter(session =>\r\n        session.childId.firstName.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n        session.childId.lastName.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n        session.sessionType.toLowerCase().includes(searchTerm.toLowerCase())\r\n      );\r\n    }\r\n\r\n    setFilteredSessions(filtered);\r\n    setCurrentPage(1);\r\n  }, [sessions, statusFilter, searchTerm]);\r\n\r\n  // Cargar sesiones al montar el componente\r\n  useEffect(() => {\r\n    loadSessions();\r\n  }, [token]);\r\n\r\n  // Debug: monitorear estado del modal\r\n  useEffect(() => {\r\n    console.log('🎭 Estado showCreateModal cambiado:', showCreateModal);\r\n  }, [showCreateModal]);\r\n\r\n  // Debug: verificar usuario y rol\r\n  useEffect(() => {\r\n    console.log('👤 Usuario actual:', user);\r\n    console.log('🎯 Rol del usuario:', user?.role);\r\n  }, [user]);\r\n\r\n  // Obtener sesiones de la página actual\r\n  const startIndex = (currentPage - 1) * itemsPerPage;\r\n  const endIndex = startIndex + itemsPerPage;\r\n  const currentSessions = filteredSessions.slice(startIndex, endIndex);\r\n  const totalPages = Math.ceil(filteredSessions.length / itemsPerPage);\r\n\r\n  // Función para iniciar sesión\r\n  const startSession = async (sessionId: string) => {\r\n    if (!token) return;\r\n\r\n    try {\r\n      const response = await fetch(`/api/sessions/${sessionId}/start`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json'\r\n        }\r\n      });\r\n\r\n      if (response.ok) {\r\n        loadSessions(); // Recargar sesiones\r\n      } else {\r\n        setError('Error al iniciar la sesión');\r\n      }\r\n    } catch (err) {\r\n      setError('Error de conexión');\r\n    }\r\n  };\r\n\r\n  // Función para finalizar sesión\r\n  const endSession = async (sessionId: string) => {\r\n    if (!token) return;\r\n\r\n    try {\r\n      const response = await fetch(`/api/sessions/${sessionId}/end`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify({\r\n          notes: 'Sesión completada',\r\n          gamesPlayed: 0,\r\n          accuracy: 0\r\n        })\r\n      });\r\n\r\n      if (response.ok) {\r\n        loadSessions(); // Recargar sesiones\r\n      } else {\r\n        setError('Error al finalizar la sesión');\r\n      }\r\n    } catch (err) {\r\n      setError('Error de conexión');\r\n    }\r\n  };\r\n\r\n  // Función para eliminar sesión\r\n  const deleteSession = async (sessionId: string) => {\r\n    if (!token || !confirm('¿Estás seguro de que quieres eliminar esta sesión?')) return;\r\n\r\n    try {\r\n      const response = await fetch(`/api/sessions/${sessionId}`, {\r\n        method: 'DELETE',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json'\r\n        }\r\n      });\r\n\r\n      if (response.ok) {\r\n        loadSessions(); // Recargar sesiones\r\n      } else {\r\n        setError('Error al eliminar la sesión');\r\n      }\r\n    } catch (err) {\r\n      setError('Error de conexión');\r\n    }\r\n  };\r\n\r\n  // Función para obtener color del estado\r\n  const getStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'scheduled':\r\n        return 'bg-blue-100 text-blue-800';\r\n      case 'in_progress':\r\n        return 'bg-green-100 text-green-800';\r\n      case 'completed':\r\n        return 'bg-gray-100 text-gray-800';\r\n      case 'cancelled':\r\n        return 'bg-red-100 text-red-800';\r\n      default:\r\n        return 'bg-gray-100 text-gray-800';\r\n    }\r\n  };\r\n\r\n  // Función para obtener texto del estado\r\n  const getStatusText = (status: string) => {\r\n    switch (status) {\r\n      case 'scheduled':\r\n        return 'Programada';\r\n      case 'in_progress':\r\n        return 'En Progreso';\r\n      case 'completed':\r\n        return 'Completada';\r\n      case 'cancelled':\r\n        return 'Cancelada';\r\n      default:\r\n        return status;\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto\"></div>\r\n          <p className=\"mt-4 text-gray-600\">Cargando sesiones...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6\">\r\n      <div className=\"max-w-7xl mx-auto\">\r\n        {/* Header */}\r\n        <motion.div\r\n          initial={{ opacity: 0, y: -20 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          className=\"mb-8\"\r\n        >\r\n          <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4\">\r\n            <div>\r\n              <h1 className=\"text-3xl font-bold text-gray-900 mb-2\">\r\n                Gestión de Sesiones\r\n              </h1>\r\n              <p className=\"text-gray-600\">\r\n                Administra todas las sesiones de terapia\r\n              </p>\r\n            </div>\r\n            \r\n            {/* Botón de prueba siempre visible */}\r\n            <motion.button\r\n              whileHover={{ scale: 1.05 }}\r\n              whileTap={{ scale: 0.95 }}\r\n              onClick={() => {\r\n                console.log('🔘 Botón Nueva Sesión clickeado');\r\n                console.log('👤 Usuario:', user);\r\n                console.log('🎯 Estado showCreateModal antes:', showCreateModal);\r\n                setShowCreateModal(true);\r\n                console.log('🎯 Estado showCreateModal después:', true);\r\n                alert('¡Botón clickeado! Modal debería abrirse.');\r\n              }}\r\n              className=\"bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg flex items-center gap-2 transition-colors duration-200 text-lg font-bold\"\r\n            >\r\n              <Plus className=\"h-6 w-6\" />\r\n              🚨 BOTÓN DE PRUEBA 🚨\r\n            </motion.button>\r\n            \r\n            {/* Botón original condicional */}\r\n            {user?.role === 'slp' && (\r\n              <motion.button\r\n                whileHover={{ scale: 1.05 }}\r\n                whileTap={{ scale: 0.95 }}\r\n                onClick={() => {\r\n                  console.log('🔘 Botón Nueva Sesión clickeado');\r\n                  console.log('👤 Usuario:', user);\r\n                  console.log('🎯 Estado showCreateModal antes:', showCreateModal);\r\n                  setShowCreateModal(true);\r\n                  console.log('🎯 Estado showCreateModal después:', true);\r\n                }}\r\n                className=\"bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg flex items-center gap-2 transition-colors duration-200\"\r\n              >\r\n                <Plus className=\"h-5 w-5\" />\r\n                Nueva Sesión (SLP)\r\n              </motion.button>\r\n            )}\r\n          </div>\r\n        </motion.div>\r\n\r\n        {/* Filtros y búsqueda */}\r\n        <motion.div\r\n          initial={{ opacity: 0, y: 20 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          transition={{ delay: 0.1 }}\r\n          className=\"bg-white rounded-xl shadow-sm p-6 mb-6\"\r\n        >\r\n          <div className=\"flex flex-col lg:flex-row gap-4\">\r\n            {/* Búsqueda */}\r\n            <div className=\"flex-1\">\r\n              <div className=\"relative\">\r\n                <Search className=\"h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400\" />\r\n                <input\r\n                  type=\"text\"\r\n                  placeholder=\"Buscar por estudiante o tipo de sesión...\"\r\n                  value={searchTerm}\r\n                  onChange={(e) => setSearchTerm(e.target.value)}\r\n                  className=\"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            {/* Filtro por estado */}\r\n            <div className=\"flex items-center gap-2\">\r\n              <Filter className=\"h-5 w-5 text-gray-400\" />\r\n              <select\r\n                value={statusFilter}\r\n                onChange={(e) => setStatusFilter(e.target.value)}\r\n                className=\"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n              >\r\n                <option value=\"all\">Todos los estados</option>\r\n                <option value=\"scheduled\">Programadas</option>\r\n                <option value=\"in_progress\">En Progreso</option>\r\n                <option value=\"completed\">Completadas</option>\r\n                <option value=\"cancelled\">Canceladas</option>\r\n              </select>\r\n            </div>\r\n          </div>\r\n        </motion.div>\r\n\r\n        {/* Mensaje de error */}\r\n        {error && (\r\n          <motion.div\r\n            initial={{ opacity: 0, scale: 0.95 }}\r\n            animate={{ opacity: 1, scale: 1 }}\r\n            className=\"bg-red-50 border border-red-200 rounded-lg p-4 mb-6\"\r\n          >\r\n            <p className=\"text-red-800\">{error}</p>\r\n          </motion.div>\r\n        )}\r\n\r\n        {/* Lista de sesiones */}\r\n        <motion.div\r\n          initial={{ opacity: 0, y: 20 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          transition={{ delay: 0.2 }}\r\n          className=\"bg-white rounded-xl shadow-sm overflow-hidden\"\r\n        >\r\n          {currentSessions.length === 0 ? (\r\n            <div className=\"p-12 text-center\">\r\n              <Activity className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\r\n              <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\r\n                No hay sesiones\r\n              </h3>\r\n              <p className=\"text-gray-600\">\r\n                {searchTerm || statusFilter !== 'all' \r\n                  ? 'No se encontraron sesiones con los filtros aplicados'\r\n                  : 'Aún no has creado ninguna sesión'}\r\n              </p>\r\n            </div>\r\n          ) : (\r\n            <>\r\n              {/* Header de la tabla */}\r\n              <div className=\"bg-gray-50 px-6 py-3 border-b border-gray-200\">\r\n                <div className=\"grid grid-cols-1 lg:grid-cols-6 gap-4 text-sm font-medium text-gray-500 uppercase tracking-wider\">\r\n                  <div>Estudiante</div>\r\n                  <div>Fecha y Hora</div>\r\n                  <div>Tipo</div>\r\n                  <div>Estado</div>\r\n                  <div>Duración</div>\r\n                  <div>Acciones</div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Filas de sesiones */}\r\n              <div className=\"divide-y divide-gray-200\">\r\n                <AnimatePresence>\r\n                  {currentSessions.map((session, index) => (\r\n                    <motion.div\r\n                      key={session._id}\r\n                      initial={{ opacity: 0, x: -20 }}\r\n                      animate={{ opacity: 1, x: 0 }}\r\n                      exit={{ opacity: 0, x: 20 }}\r\n                      transition={{ delay: index * 0.05 }}\r\n                      className=\"px-6 py-4 hover:bg-gray-50 transition-colors duration-150\"\r\n                    >\r\n                      <div className=\"grid grid-cols-1 lg:grid-cols-6 gap-4 items-center\">\r\n                        {/* Estudiante */}\r\n                        <div className=\"flex items-center\">\r\n                          <div className=\"h-8 w-8 bg-blue-100 rounded-full flex items-center justify-center mr-3\">\r\n                            <UserCheck className=\"h-4 w-4 text-blue-600\" />\r\n                          </div>\r\n                          <div>\r\n                            <p className=\"text-sm font-medium text-gray-900\">\r\n                              {session.childId.firstName} {session.childId.lastName}\r\n                            </p>\r\n                          </div>\r\n                        </div>\r\n\r\n                        {/* Fecha y Hora */}\r\n                        <div>\r\n                          <p className=\"text-sm text-gray-900\">\r\n                            {new Date(session.scheduledDate).toLocaleDateString('es-ES', {\r\n                              day: '2-digit',\r\n                              month: '2-digit',\r\n                              year: 'numeric'\r\n                            })}\r\n                          </p>\r\n                          <p className=\"text-sm text-gray-500\">\r\n                            {new Date(session.scheduledDate).toLocaleTimeString('es-ES', {\r\n                              hour: '2-digit',\r\n                              minute: '2-digit'\r\n                            })}\r\n                          </p>\r\n                        </div>\r\n\r\n                        {/* Tipo */}\r\n                        <div>\r\n                          <span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800\">\r\n                            {session.sessionType === 'therapy' ? 'Terapia' :\r\n                             session.sessionType === 'evaluation' ? 'Evaluación' : 'Juego'}\r\n                          </span>\r\n                        </div>\r\n\r\n                        {/* Estado */}\r\n                        <div>\r\n                          <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${getStatusColor(session.status)}`}>\r\n                            {getStatusText(session.status)}\r\n                          </span>\r\n                        </div>\r\n\r\n                        {/* Duración */}\r\n                        <div>\r\n                          <p className=\"text-sm text-gray-900\">\r\n                            {session.duration || 45} min\r\n                          </p>\r\n                        </div>\r\n\r\n                        {/* Acciones */}\r\n                        {user?.role === 'slp' && (\r\n                          <div className=\"flex items-center gap-2\">\r\n                            {session.status === 'scheduled' && (\r\n                              <>\r\n                                <button\r\n                                  onClick={() => startSession(session._id)}\r\n                                  className=\"p-2 text-green-600 hover:bg-green-100 rounded-lg transition-colors duration-150\"\r\n                                  title=\"Iniciar sesión\"\r\n                                >\r\n                                  <Play className=\"h-4 w-4\" />\r\n                                </button>\r\n                                <button\r\n                                  onClick={() => setEditingSession(session)}\r\n                                  className=\"p-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors duration-150\"\r\n                                  title=\"Editar sesión\"\r\n                                >\r\n                                  <Edit className=\"h-4 w-4\" />\r\n                                </button>\r\n                                <button\r\n                                  onClick={() => deleteSession(session._id)}\r\n                                  className=\"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors duration-150\"\r\n                                  title=\"Eliminar sesión\"\r\n                                >\r\n                                  <Trash2 className=\"h-4 w-4\" />\r\n                                </button>\r\n                              </>\r\n                            )}\r\n                            \r\n                            {session.status === 'in_progress' && (\r\n                              <button\r\n                                onClick={() => endSession(session._id)}\r\n                                className=\"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors duration-150\"\r\n                                title=\"Finalizar sesión\"\r\n                              >\r\n                                <Square className=\"h-4 w-4\" />\r\n                              </button>\r\n                            )}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </motion.div>\r\n                  ))}\r\n                </AnimatePresence>\r\n              </div>\r\n            </>\r\n          )}\r\n        </motion.div>\r\n\r\n        {/* Paginación */}\r\n        {totalPages > 1 && (\r\n          <motion.div\r\n            initial={{ opacity: 0, y: 20 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            transition={{ delay: 0.3 }}\r\n            className=\"mt-6 flex justify-center\"\r\n          >\r\n            <div className=\"flex items-center gap-2\">\r\n              <button\r\n                onClick={() => setCurrentPage(Math.max(1, currentPage - 1))}\r\n                disabled={currentPage === 1}\r\n                className=\"p-2 rounded-lg border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50\"\r\n              >\r\n                <ChevronLeft className=\"h-4 w-4\" />\r\n              </button>\r\n              \r\n              <span className=\"px-4 py-2 text-sm text-gray-700\">\r\n                Página {currentPage} de {totalPages}\r\n              </span>\r\n              \r\n              <button\r\n                onClick={() => setCurrentPage(Math.min(totalPages, currentPage + 1))}\r\n                disabled={currentPage === totalPages}\r\n                className=\"p-2 rounded-lg border border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50\"\r\n              >\r\n                <ChevronRight className=\"h-4 w-4\" />\r\n              </button>\r\n            </div>\r\n          </motion.div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Modales */}\r\n      <CreateSessionModal\r\n        isOpen={showCreateModal}\r\n        onClose={() => setShowCreateModal(false)}\r\n        onSuccess={() => {\r\n          loadSessions();\r\n          setShowCreateModal(false);\r\n        }}\r\n      />\r\n\r\n      <EditSessionModal\r\n        isOpen={!!editingSession}\r\n        onClose={() => setEditingSession(null)}\r\n        onSuccess={() => {\r\n          loadSessions();\r\n          setEditingSession(null);\r\n        }}\r\n        session={editingSession}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Sessions;\r\n"],"names":["EditSessionModal","isOpen","onClose","onSuccess","session","token","useAuthStore","loading","setLoading","useState","error","setError","formData","setFormData","goalInput","setGoalInput","useEffect","handleInputChange","field","value","prev","addGoal","removeGoal","goalToRemove","goal","handleSubmit","e","response","errorData","_a","AnimatePresence","jsxs","jsx","motion","Calendar","X","AlertTriangle","Clock","Target","index","FileText","Fragment","Loader2","Save","Sessions","user","sessions","setSessions","filteredSessions","setFilteredSessions","showCreateModal","setShowCreateModal","editingSession","setEditingSession","statusFilter","setStatusFilter","searchTerm","setSearchTerm","currentPage","setCurrentPage","itemsPerPage","loadSessions","data","filtered","startIndex","endIndex","currentSessions","totalPages","startSession","sessionId","endSession","deleteSession","getStatusColor","status","getStatusText","Plus","Search","Filter","Activity","UserCheck","Play","Edit","Trash2","Square","ChevronLeft","ChevronRight","CreateSessionModal"],"mappings":"4XAuDA,MAAMA,GAAoD,CAAC,CACzD,OAAAC,EACA,QAAAC,EACA,UAAAC,EACA,QAAAC,CACF,IAAM,CACJ,KAAM,CAAE,MAAAC,CAAA,EAAUC,EAAA,EACZ,CAACC,EAASC,CAAU,EAAIC,EAAAA,SAAS,EAAK,EACtC,CAACC,EAAOC,CAAQ,EAAIF,EAAAA,SAAwB,IAAI,EAGhD,CAACG,EAAUC,CAAW,EAAIJ,WAA0B,CACxD,cAAe,GACf,SAAU,GACV,YAAa,UACb,MAAO,GACP,MAAO,CAAA,CAAC,CACT,EAEK,CAACK,EAAWC,CAAY,EAAIN,EAAAA,SAAS,EAAE,EAG7CO,EAAAA,UAAU,IAAM,CACVf,GAAUG,IACZS,EAAY,CACV,cAAeT,EAAQ,cAAc,MAAM,GAAG,EAAE,CAAC,EACjD,SAAUA,EAAQ,UAAY,GAC9B,YAAaA,EAAQ,YACrB,MAAOA,EAAQ,OAAS,GACxB,MAAO,CAAC,GAAIA,EAAQ,OAAS,CAAA,CAAG,CAAA,CACjC,EACDW,EAAa,EAAE,EACfJ,EAAS,IAAI,EAEjB,EAAG,CAACV,EAAQG,CAAO,CAAC,EAGpB,MAAMa,EAAoB,CAACC,EAA8BC,IAAe,CACtEN,EAAYO,IAAS,CACnB,GAAGA,EACH,CAACF,CAAK,EAAGC,CAAA,EACT,CACJ,EAGME,EAAU,IAAM,CAChBP,EAAU,KAAA,GAAU,CAACF,EAAS,MAAO,SAASE,EAAU,KAAA,CAAM,IAChED,EAAYO,IAAS,CACnB,GAAGA,EACH,MAAO,CAAC,GAAIA,EAAK,OAAS,CAAA,EAAKN,EAAU,KAAA,CAAM,CAAA,EAC/C,EACFC,EAAa,EAAE,EAEnB,EAGMO,EAAcC,GAAyB,CAC3CV,EAAYO,IAAS,CACnB,GAAGA,EACH,MAAOA,EAAK,MAAO,OAAOI,GAAQA,IAASD,CAAY,CAAA,EACvD,CACJ,EAGME,EAAe,MAAOC,GAAuB,OAEjD,GADAA,EAAE,eAAA,EACE,GAACrB,GAAS,CAACD,GAGf,IAAI,CAACQ,EAAS,cAAe,CAC3BD,EAAS,6BAA6B,EACtC,MACF,CAEA,GAAIC,EAAS,SAAW,IAAMA,EAAS,SAAW,IAAK,CACrDD,EAAS,+CAA+C,EACxD,MACF,CAEA,GAAI,CACFH,EAAW,EAAI,EACfG,EAAS,IAAI,EAEb,MAAMgB,EAAW,MAAM,MAAM,iBAAiBvB,EAAQ,GAAG,GAAI,CAC3D,OAAQ,MACR,QAAS,CACP,cAAiB,UAAUC,CAAK,GAChC,eAAgB,kBAAA,EAElB,KAAM,KAAK,UAAUO,CAAQ,CAAA,CAC9B,EAED,GAAIe,EAAS,GACXxB,EAAA,EACAD,EAAA,MACK,CACL,MAAM0B,EAAY,MAAMD,EAAS,KAAA,EACjChB,IAASkB,EAAAD,EAAU,QAAV,YAAAC,EAAiB,UAAW,+BAA+B,CACtE,CACF,MAAc,CACZlB,EAAS,mBAAmB,CAC9B,QAAA,CACEH,EAAW,EAAK,CAClB,EACF,EAEA,OAAKJ,QAGF0B,EAAA,CACE,SAAA7B,GACC8B,OAAC,MAAA,CAAI,UAAU,qCAEb,SAAA,CAAAC,EAAAA,IAACC,EAAO,IAAP,CACC,QAAS,CAAE,QAAS,CAAA,EACpB,QAAS,CAAE,QAAS,CAAA,EACpB,KAAM,CAAE,QAAS,CAAA,EACjB,UAAU,0DACV,QAAS/B,CAAA,CAAA,EAIX8B,EAAAA,IAAC,MAAA,CAAI,UAAU,kDACb,SAAAD,EAAAA,KAACE,EAAO,IAAP,CACC,QAAS,CAAE,QAAS,EAAG,MAAO,GAAA,EAC9B,QAAS,CAAE,QAAS,EAAG,MAAO,CAAA,EAC9B,KAAM,CAAE,QAAS,EAAG,MAAO,GAAA,EAC3B,UAAU,8EAGV,SAAA,CAAAF,EAAAA,KAAC,MAAA,CAAI,UAAU,iEACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,oBACb,SAAA,CAAAC,EAAAA,IAACE,EAAA,CAAS,UAAU,4BAAA,CAA6B,SAChD,MAAA,CACC,SAAA,CAAAF,EAAAA,IAAC,KAAA,CAAG,UAAU,sCAAsC,SAAA,gBAEpD,EACAD,EAAAA,KAAC,IAAA,CAAE,UAAU,wBACV,SAAA,CAAA3B,EAAQ,QAAQ,UAAU,IAAEA,EAAQ,QAAQ,QAAA,CAAA,CAC/C,CAAA,CAAA,CACF,CAAA,EACF,EACA4B,EAAAA,IAAC,SAAA,CACC,QAAS9B,EACT,UAAU,uFAEV,SAAA8B,EAAAA,IAACG,EAAA,CAAE,UAAU,SAAA,CAAU,CAAA,CAAA,CACzB,EACF,EAGAJ,EAAAA,KAAC,OAAA,CAAK,SAAUN,EAAc,UAAU,gBAErC,SAAA,CAAAf,SACE,MAAA,CAAI,UAAU,iDACb,SAAAqB,EAAAA,KAAC,IAAA,CAAE,UAAU,yCACX,SAAA,CAAAC,EAAAA,IAACI,EAAA,CAAc,UAAU,cAAA,CAAe,EACvC1B,CAAA,CAAA,CACH,CAAA,CACF,EAIFqB,EAAAA,KAAC,MAAA,CAAI,UAAU,4BACb,SAAA,CAAAC,EAAAA,IAAC,KAAA,CAAG,UAAU,yCAAyC,SAAA,0BAEvD,EACAD,EAAAA,KAAC,MAAA,CAAI,UAAU,iCACb,SAAA,CAAAA,OAAC,MAAA,CACC,SAAA,CAAAC,EAAAA,IAAC,OAAA,CAAK,UAAU,gBAAgB,SAAA,cAAW,EAC3CD,EAAAA,KAAC,IAAA,CAAE,UAAU,cAAe,SAAA,CAAA3B,EAAQ,QAAQ,UAAU,IAAEA,EAAQ,QAAQ,QAAA,CAAA,CAAS,CAAA,EACnF,SACC,MAAA,CACC,SAAA,CAAA4B,EAAAA,IAAC,OAAA,CAAK,UAAU,gBAAgB,SAAA,UAAO,EACvCA,EAAAA,IAAC,IAAA,CAAE,UAAU,yBAA0B,WAAQ,MAAA,CAAO,CAAA,EACxD,SACC,MAAA,CACC,SAAA,CAAAA,EAAAA,IAAC,OAAA,CAAK,UAAU,gBAAgB,SAAA,gBAAa,EAC7CA,EAAAA,IAAC,IAAA,CAAE,UAAU,sBAAuB,WAAQ,GAAA,CAAI,CAAA,EAClD,SACC,MAAA,CACC,SAAA,CAAAA,EAAAA,IAAC,OAAA,CAAK,UAAU,gBAAgB,SAAA,kBAAe,QAC9C,IAAA,CAAE,UAAU,cAAe,SAAA5B,EAAQ,aAAe,CAAA,CAAE,CAAA,CAAA,CACvD,CAAA,CAAA,CACF,CAAA,EACF,EAGA2B,EAAAA,KAAC,MAAA,CAAI,UAAU,YACb,SAAA,CAAAA,EAAAA,KAAC,KAAA,CAAG,UAAU,sDACZ,SAAA,CAAAC,EAAAA,IAACE,EAAA,CAAS,UAAU,cAAA,CAAe,EAAE,uBAAA,EAEvC,EAGAH,EAAAA,KAAC,MAAA,CAAI,UAAU,yBACb,SAAA,CAAAA,OAAC,MAAA,CACC,SAAA,CAAAA,EAAAA,KAAC,QAAA,CAAM,UAAU,+CACf,SAAA,CAAAC,EAAAA,IAACE,EAAA,CAAS,UAAU,qBAAA,CAAsB,EAAE,SAAA,EAE9C,EACAF,EAAAA,IAAC,QAAA,CACC,KAAK,OACL,MAAOpB,EAAS,cAChB,SAAWc,GAAMT,EAAkB,gBAAiBS,EAAE,OAAO,KAAK,EAClE,UAAU,+GACV,SAAQ,EAAA,CAAA,CACV,EACF,SAEC,MAAA,CACC,SAAA,CAAAK,EAAAA,KAAC,QAAA,CAAM,UAAU,+CACf,SAAA,CAAAC,EAAAA,IAACK,EAAA,CAAM,UAAU,qBAAA,CAAsB,EAAE,sBAAA,EAE3C,EACAL,EAAAA,IAAC,QAAA,CACC,KAAK,SACL,IAAI,KACJ,IAAI,MACJ,MAAOpB,EAAS,SAChB,SAAWc,GAAMT,EAAkB,WAAY,SAASS,EAAE,OAAO,KAAK,CAAC,EACvE,UAAU,+GACV,SAAQ,EAAA,CAAA,CACV,CAAA,CACF,CAAA,EACF,SAGC,MAAA,CACC,SAAA,CAAAM,EAAAA,IAAC,QAAA,CAAM,UAAU,+CAA+C,SAAA,iBAEhE,EACAD,EAAAA,KAAC,SAAA,CACC,MAAOnB,EAAS,YAChB,SAAWc,GAAMT,EAAkB,cAAeS,EAAE,OAAO,KAAK,EAChE,UAAU,+GAEV,SAAA,CAAAM,EAAAA,IAAC,SAAA,CAAO,MAAM,UAAU,SAAA,UAAO,EAC/BA,EAAAA,IAAC,SAAA,CAAO,MAAM,aAAa,SAAA,aAAU,EACrCA,EAAAA,IAAC,SAAA,CAAO,MAAM,OAAO,SAAA,OAAA,CAAK,CAAA,CAAA,CAAA,CAC5B,CAAA,CACF,CAAA,EACF,EAGAD,EAAAA,KAAC,MAAA,CAAI,UAAU,YACb,SAAA,CAAAA,EAAAA,KAAC,KAAA,CAAG,UAAU,oCACZ,SAAA,CAAAC,EAAAA,IAACM,EAAA,CAAO,UAAU,qBAAA,CAAsB,EAAE,wBAAA,EAE5C,EAGAP,EAAAA,KAAC,MAAA,CAAI,UAAU,aACb,SAAA,CAAAC,EAAAA,IAAC,QAAA,CACC,KAAK,OACL,MAAOlB,EACP,SAAWY,GAAMX,EAAaW,EAAE,OAAO,KAAK,EAC5C,WAAaA,GAAMA,EAAE,MAAQ,UAAYA,EAAE,iBAAkBL,KAC7D,YAAY,sCACZ,UAAU,8GAAA,CAAA,EAEZW,EAAAA,IAAC,SAAA,CACC,KAAK,SACL,QAASX,EACT,UAAU,kFACX,SAAA,SAAA,CAAA,CAED,EACF,EAGCT,EAAS,OAASA,EAAS,MAAM,OAAS,GACzCoB,EAAAA,IAAC,MAAA,CAAI,UAAU,YACZ,SAAApB,EAAS,MAAM,IAAI,CAACY,EAAMe,IACzBR,EAAAA,KAAC,MAAA,CAEC,UAAU,oEAEV,SAAA,CAAAC,EAAAA,IAAC,OAAA,CAAK,UAAU,wBAAyB,SAAAR,EAAK,EAC9CQ,EAAAA,IAAC,SAAA,CACC,KAAK,SACL,QAAS,IAAMV,EAAWE,CAAI,EAC9B,UAAU,wCAEV,SAAAQ,EAAAA,IAACG,EAAA,CAAE,UAAU,SAAA,CAAU,CAAA,CAAA,CACzB,CAAA,EAVKI,CAAA,CAYR,CAAA,CACH,CAAA,EAEJ,SAGC,MAAA,CACC,SAAA,CAAAR,EAAAA,KAAC,QAAA,CAAM,UAAU,+CACf,SAAA,CAAAC,EAAAA,IAACQ,EAAA,CAAS,UAAU,qBAAA,CAAsB,EAAE,mBAAA,EAE9C,EACAR,EAAAA,IAAC,WAAA,CACC,MAAOpB,EAAS,MAChB,SAAWc,GAAMT,EAAkB,QAASS,EAAE,OAAO,KAAK,EAC1D,KAAM,EACN,YAAY,sCACZ,UAAU,0HAAA,CAAA,CACZ,EACF,EAGAK,EAAAA,KAAC,MAAA,CAAI,UAAU,uDACb,SAAA,CAAAC,EAAAA,IAAC,SAAA,CACC,KAAK,SACL,QAAS9B,EACT,UAAU,qFACX,SAAA,UAAA,CAAA,EAGD8B,EAAAA,IAAC,SAAA,CACC,KAAK,SACL,SAAUzB,EACV,UAAU,0JAET,WACCwB,EAAAA,KAAAU,EAAAA,SAAA,CACE,SAAA,CAAAT,EAAAA,IAACU,EAAA,CAAQ,UAAU,sBAAA,CAAuB,EAAE,cAAA,CAAA,CAE9C,EAEAX,EAAAA,KAAAU,EAAAA,SAAA,CACE,SAAA,CAAAT,EAAAA,IAACW,EAAA,CAAK,UAAU,SAAA,CAAU,EAAE,iBAAA,CAAA,CAE9B,CAAA,CAAA,CAEJ,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CAAA,CAAA,CACF,CACF,CAAA,CAAA,CACF,CAAA,CAEJ,EAzOmB,IA2OvB,ECnVMC,GAAqB,IAAM,CAC/B,KAAM,CAAE,KAAAC,EAAM,MAAAxC,CAAA,EAAUC,EAAA,EAClB,CAACwC,EAAUC,CAAW,EAAItC,EAAAA,SAAoB,CAAA,CAAE,EAChD,CAACuC,EAAkBC,CAAmB,EAAIxC,EAAAA,SAAoB,CAAA,CAAE,EAChE,CAACF,EAASC,CAAU,EAAIC,EAAAA,SAAS,EAAI,EACrC,CAACC,EAAOC,CAAQ,EAAIF,EAAAA,SAAwB,IAAI,EAChD,CAACyC,EAAiBC,CAAkB,EAAI1C,EAAAA,SAAS,EAAK,EACtD,CAAC2C,EAAgBC,CAAiB,EAAI5C,EAAAA,SAAyB,IAAI,EAGnE,CAAC6C,EAAcC,CAAe,EAAI9C,EAAAA,SAAiB,KAAK,EACxD,CAAC+C,EAAYC,CAAa,EAAIhD,EAAAA,SAAS,EAAE,EACzC,CAACiD,EAAaC,CAAc,EAAIlD,EAAAA,SAAS,CAAC,EAC1C,CAACmD,CAAY,EAAInD,EAAAA,SAAS,EAAE,EAG5BoD,EAAe,SAAY,CAC/B,GAAKxD,EAEL,GAAI,CACFG,EAAW,EAAI,EACf,MAAMmB,EAAW,MAAM,MAAM,gBAAiB,CAC5C,QAAS,CACP,cAAiB,UAAUtB,CAAK,GAChC,eAAgB,kBAAA,CAClB,CACD,EAED,GAAIsB,EAAS,GAAI,CACf,MAAMmC,EAAO,MAAMnC,EAAS,KAAA,EAC5BoB,EAAYe,EAAK,KAAK,UAAY,CAAA,CAAE,CACtC,MACEnD,EAAS,8BAA8B,CAE3C,MAAc,CACZA,EAAS,mBAAmB,CAC9B,QAAA,CACEH,EAAW,EAAK,CAClB,CACF,EAGAQ,EAAAA,UAAU,IAAM,CACd,IAAI+C,EAAWjB,EAGXQ,IAAiB,QACnBS,EAAWA,EAAS,OAAO3D,GAAWA,EAAQ,SAAWkD,CAAY,GAInEE,IACFO,EAAWA,EAAS,OAAO3D,GACzBA,EAAQ,QAAQ,UAAU,YAAA,EAAc,SAASoD,EAAW,aAAa,GACzEpD,EAAQ,QAAQ,SAAS,cAAc,SAASoD,EAAW,YAAA,CAAa,GACxEpD,EAAQ,YAAY,YAAA,EAAc,SAASoD,EAAW,YAAA,CAAa,CAAA,GAIvEP,EAAoBc,CAAQ,EAC5BJ,EAAe,CAAC,CAClB,EAAG,CAACb,EAAUQ,EAAcE,CAAU,CAAC,EAGvCxC,EAAAA,UAAU,IAAM,CACd6C,EAAA,CACF,EAAG,CAACxD,CAAK,CAAC,EAGVW,EAAAA,UAAU,IAAM,CACd,QAAQ,IAAI,sCAAuCkC,CAAe,CACpE,EAAG,CAACA,CAAe,CAAC,EAGpBlC,EAAAA,UAAU,IAAM,CACd,QAAQ,IAAI,qBAAsB6B,CAAI,EACtC,QAAQ,IAAI,sBAAuBA,GAAA,YAAAA,EAAM,IAAI,CAC/C,EAAG,CAACA,CAAI,CAAC,EAGT,MAAMmB,GAAcN,EAAc,GAAKE,EACjCK,EAAWD,EAAaJ,EACxBM,EAAkBlB,EAAiB,MAAMgB,EAAYC,CAAQ,EAC7DE,EAAa,KAAK,KAAKnB,EAAiB,OAASY,CAAY,EAG7DQ,EAAe,MAAOC,GAAsB,CAChD,GAAKhE,EAEL,GAAI,EACe,MAAM,MAAM,iBAAiBgE,CAAS,SAAU,CAC/D,OAAQ,OACR,QAAS,CACP,cAAiB,UAAUhE,CAAK,GAChC,eAAgB,kBAAA,CAClB,CACD,GAEY,GACXwD,EAAA,EAEAlD,EAAS,4BAA4B,CAEzC,MAAc,CACZA,EAAS,mBAAmB,CAC9B,CACF,EAGM2D,EAAa,MAAOD,GAAsB,CAC9C,GAAKhE,EAEL,GAAI,EACe,MAAM,MAAM,iBAAiBgE,CAAS,OAAQ,CAC7D,OAAQ,OACR,QAAS,CACP,cAAiB,UAAUhE,CAAK,GAChC,eAAgB,kBAAA,EAElB,KAAM,KAAK,UAAU,CACnB,MAAO,oBACP,YAAa,EACb,SAAU,CAAA,CACX,CAAA,CACF,GAEY,GACXwD,EAAA,EAEAlD,EAAS,8BAA8B,CAE3C,MAAc,CACZA,EAAS,mBAAmB,CAC9B,CACF,EAGM4D,EAAgB,MAAOF,GAAsB,CACjD,GAAI,GAAChE,GAAS,CAAC,QAAQ,oDAAoD,GAE3E,GAAI,EACe,MAAM,MAAM,iBAAiBgE,CAAS,GAAI,CACzD,OAAQ,SACR,QAAS,CACP,cAAiB,UAAUhE,CAAK,GAChC,eAAgB,kBAAA,CAClB,CACD,GAEY,GACXwD,EAAA,EAEAlD,EAAS,6BAA6B,CAE1C,MAAc,CACZA,EAAS,mBAAmB,CAC9B,CACF,EAGM6D,EAAkBC,GAAmB,CACzC,OAAQA,EAAA,CACN,IAAK,YACH,MAAO,4BACT,IAAK,cACH,MAAO,8BACT,IAAK,YACH,MAAO,4BACT,IAAK,YACH,MAAO,0BACT,QACE,MAAO,2BAAA,CAEb,EAGMC,EAAiBD,GAAmB,CACxC,OAAQA,EAAA,CACN,IAAK,YACH,MAAO,aACT,IAAK,cACH,MAAO,cACT,IAAK,YACH,MAAO,aACT,IAAK,YACH,MAAO,YACT,QACE,OAAOA,CAAA,CAEb,EAEA,OAAIlE,QAEC,MAAA,CAAI,UAAU,6FACb,SAAAwB,EAAAA,KAAC,MAAA,CAAI,UAAU,cACb,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,wEAAA,CAAyE,EACxFA,EAAAA,IAAC,IAAA,CAAE,UAAU,qBAAqB,SAAA,sBAAA,CAAoB,CAAA,CAAA,CACxD,CAAA,CACF,EAKFD,EAAAA,KAAC,MAAA,CAAI,UAAU,gEACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,oBAEb,SAAA,CAAAC,EAAAA,IAACC,EAAO,IAAP,CACC,QAAS,CAAE,QAAS,EAAG,EAAG,GAAA,EAC1B,QAAS,CAAE,QAAS,EAAG,EAAG,CAAA,EAC1B,UAAU,OAEV,SAAAF,EAAAA,KAAC,MAAA,CAAI,UAAU,8EACb,SAAA,CAAAA,OAAC,MAAA,CACC,SAAA,CAAAC,EAAAA,IAAC,KAAA,CAAG,UAAU,wCAAwC,SAAA,sBAEtD,EACAA,EAAAA,IAAC,IAAA,CAAE,UAAU,gBAAgB,SAAA,0CAAA,CAE7B,CAAA,EACF,EAGAD,EAAAA,KAACE,EAAO,OAAP,CACC,WAAY,CAAE,MAAO,IAAA,EACrB,SAAU,CAAE,MAAO,GAAA,EACnB,QAAS,IAAM,CACb,QAAQ,IAAI,iCAAiC,EAC7C,QAAQ,IAAI,cAAeY,CAAI,EAC/B,QAAQ,IAAI,mCAAoCK,CAAe,EAC/DC,EAAmB,EAAI,EACvB,QAAQ,IAAI,qCAAsC,EAAI,EACtD,MAAM,0CAA0C,CAClD,EACA,UAAU,uIAEV,SAAA,CAAAnB,EAAAA,IAAC2C,EAAA,CAAK,UAAU,SAAA,CAAU,EAAE,uBAAA,CAAA,CAAA,GAK7B9B,GAAA,YAAAA,EAAM,QAAS,OACdd,EAAAA,KAACE,EAAO,OAAP,CACC,WAAY,CAAE,MAAO,IAAA,EACrB,SAAU,CAAE,MAAO,GAAA,EACnB,QAAS,IAAM,CACb,QAAQ,IAAI,iCAAiC,EAC7C,QAAQ,IAAI,cAAeY,CAAI,EAC/B,QAAQ,IAAI,mCAAoCK,CAAe,EAC/DC,EAAmB,EAAI,EACvB,QAAQ,IAAI,qCAAsC,EAAI,CACxD,EACA,UAAU,yHAEV,SAAA,CAAAnB,EAAAA,IAAC2C,EAAA,CAAK,UAAU,SAAA,CAAU,EAAE,oBAAA,CAAA,CAAA,CAE9B,CAAA,CAEJ,CAAA,CAAA,EAIF3C,EAAAA,IAACC,EAAO,IAAP,CACC,QAAS,CAAE,QAAS,EAAG,EAAG,EAAA,EAC1B,QAAS,CAAE,QAAS,EAAG,EAAG,CAAA,EAC1B,WAAY,CAAE,MAAO,EAAA,EACrB,UAAU,yCAEV,SAAAF,EAAAA,KAAC,MAAA,CAAI,UAAU,kCAEb,SAAA,CAAAC,EAAAA,IAAC,OAAI,UAAU,SACb,SAAAD,EAAAA,KAAC,MAAA,CAAI,UAAU,WACb,SAAA,CAAAC,EAAAA,IAAC4C,EAAA,CAAO,UAAU,0EAAA,CAA2E,EAC7F5C,EAAAA,IAAC,QAAA,CACC,KAAK,OACL,YAAY,4CACZ,MAAOwB,EACP,SAAW9B,GAAM+B,EAAc/B,EAAE,OAAO,KAAK,EAC7C,UAAU,oHAAA,CAAA,CACZ,CAAA,CACF,CAAA,CACF,EAGAK,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACb,SAAA,CAAAC,EAAAA,IAAC6C,EAAA,CAAO,UAAU,uBAAA,CAAwB,EAC1C9C,EAAAA,KAAC,SAAA,CACC,MAAOuB,EACP,SAAW5B,GAAM6B,EAAgB7B,EAAE,OAAO,KAAK,EAC/C,UAAU,wGAEV,SAAA,CAAAM,EAAAA,IAAC,SAAA,CAAO,MAAM,MAAM,SAAA,oBAAiB,EACrCA,EAAAA,IAAC,SAAA,CAAO,MAAM,YAAY,SAAA,cAAW,EACrCA,EAAAA,IAAC,SAAA,CAAO,MAAM,cAAc,SAAA,cAAW,EACvCA,EAAAA,IAAC,SAAA,CAAO,MAAM,YAAY,SAAA,cAAW,EACrCA,EAAAA,IAAC,SAAA,CAAO,MAAM,YAAY,SAAA,YAAA,CAAU,CAAA,CAAA,CAAA,CACtC,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CAAA,EAIDtB,GACCsB,EAAAA,IAACC,EAAO,IAAP,CACC,QAAS,CAAE,QAAS,EAAG,MAAO,GAAA,EAC9B,QAAS,CAAE,QAAS,EAAG,MAAO,CAAA,EAC9B,UAAU,sDAEV,SAAAD,EAAAA,IAAC,IAAA,CAAE,UAAU,eAAgB,SAAAtB,CAAA,CAAM,CAAA,CAAA,EAKvCsB,EAAAA,IAACC,EAAO,IAAP,CACC,QAAS,CAAE,QAAS,EAAG,EAAG,EAAA,EAC1B,QAAS,CAAE,QAAS,EAAG,EAAG,CAAA,EAC1B,WAAY,CAAE,MAAO,EAAA,EACrB,UAAU,gDAET,WAAgB,SAAW,EAC1BF,EAAAA,KAAC,MAAA,CAAI,UAAU,mBACb,SAAA,CAAAC,EAAAA,IAAC8C,EAAA,CAAS,UAAU,sCAAA,CAAuC,EAC3D9C,EAAAA,IAAC,KAAA,CAAG,UAAU,yCAAyC,SAAA,kBAEvD,EACAA,EAAAA,IAAC,KAAE,UAAU,gBACV,YAAcsB,IAAiB,MAC5B,uDACA,kCAAA,CACN,CAAA,CAAA,CACF,EAEAvB,EAAAA,KAAAU,EAAAA,SAAA,CAEE,SAAA,CAAAT,EAAAA,IAAC,OAAI,UAAU,gDACb,SAAAD,EAAAA,KAAC,MAAA,CAAI,UAAU,mGACb,SAAA,CAAAC,EAAAA,IAAC,OAAI,SAAA,YAAA,CAAU,EACfA,EAAAA,IAAC,OAAI,SAAA,cAAA,CAAY,EACjBA,EAAAA,IAAC,OAAI,SAAA,MAAA,CAAI,EACTA,EAAAA,IAAC,OAAI,SAAA,QAAA,CAAM,EACXA,EAAAA,IAAC,OAAI,SAAA,UAAA,CAAQ,EACbA,EAAAA,IAAC,OAAI,SAAA,UAAA,CAAQ,CAAA,CAAA,CACf,CAAA,CACF,EAGAA,EAAAA,IAAC,MAAA,CAAI,UAAU,2BACb,SAAAA,EAAAA,IAACF,GACE,SAAAoC,EAAgB,IAAI,CAAC9D,EAASmC,IAC7BP,EAAAA,IAACC,EAAO,IAAP,CAEC,QAAS,CAAE,QAAS,EAAG,EAAG,GAAA,EAC1B,QAAS,CAAE,QAAS,EAAG,EAAG,CAAA,EAC1B,KAAM,CAAE,QAAS,EAAG,EAAG,EAAA,EACvB,WAAY,CAAE,MAAOM,EAAQ,GAAA,EAC7B,UAAU,4DAEV,SAAAR,EAAAA,KAAC,MAAA,CAAI,UAAU,qDAEb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,oBACb,SAAA,CAAAC,EAAAA,IAAC,OAAI,UAAU,yEACb,eAAC+C,EAAA,CAAU,UAAU,wBAAwB,CAAA,CAC/C,EACA/C,MAAC,MAAA,CACC,SAAAD,EAAAA,KAAC,IAAA,CAAE,UAAU,oCACV,SAAA,CAAA3B,EAAQ,QAAQ,UAAU,IAAEA,EAAQ,QAAQ,QAAA,CAAA,CAC/C,CAAA,CACF,CAAA,EACF,SAGC,MAAA,CACC,SAAA,CAAA4B,EAAAA,IAAC,IAAA,CAAE,UAAU,wBACV,SAAA,IAAI,KAAK5B,EAAQ,aAAa,EAAE,mBAAmB,QAAS,CAC3D,IAAK,UACL,MAAO,UACP,KAAM,SAAA,CACP,EACH,EACA4B,EAAAA,IAAC,IAAA,CAAE,UAAU,wBACV,SAAA,IAAI,KAAK5B,EAAQ,aAAa,EAAE,mBAAmB,QAAS,CAC3D,KAAM,UACN,OAAQ,SAAA,CACT,CAAA,CACH,CAAA,EACF,EAGA4B,MAAC,MAAA,CACC,SAAAA,EAAAA,IAAC,OAAA,CAAK,UAAU,wGACb,SAAA5B,EAAQ,cAAgB,UAAY,UACpCA,EAAQ,cAAgB,aAAe,aAAe,QACzD,EACF,EAGA4B,MAAC,MAAA,CACC,SAAAA,EAAAA,IAAC,OAAA,CAAK,UAAW,2EAA2EwC,EAAepE,EAAQ,MAAM,CAAC,GACvH,SAAAsE,EAActE,EAAQ,MAAM,EAC/B,EACF,EAGA4B,MAAC,MAAA,CACC,SAAAD,EAAAA,KAAC,IAAA,CAAE,UAAU,wBACV,SAAA,CAAA3B,EAAQ,UAAY,GAAG,MAAA,CAAA,CAC1B,CAAA,CACF,GAGCyC,GAAA,YAAAA,EAAM,QAAS,OACdd,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACZ,SAAA,CAAA3B,EAAQ,SAAW,aAClB2B,EAAAA,KAAAU,EAAAA,SAAA,CACE,SAAA,CAAAT,EAAAA,IAAC,SAAA,CACC,QAAS,IAAMoC,EAAahE,EAAQ,GAAG,EACvC,UAAU,kFACV,MAAM,iBAEN,SAAA4B,EAAAA,IAACgD,EAAA,CAAK,UAAU,SAAA,CAAU,CAAA,CAAA,EAE5BhD,EAAAA,IAAC,SAAA,CACC,QAAS,IAAMqB,EAAkBjD,CAAO,EACxC,UAAU,gFACV,MAAM,gBAEN,SAAA4B,EAAAA,IAACiD,EAAA,CAAK,UAAU,SAAA,CAAU,CAAA,CAAA,EAE5BjD,EAAAA,IAAC,SAAA,CACC,QAAS,IAAMuC,EAAcnE,EAAQ,GAAG,EACxC,UAAU,8EACV,MAAM,kBAEN,SAAA4B,EAAAA,IAACkD,GAAA,CAAO,UAAU,SAAA,CAAU,CAAA,CAAA,CAC9B,EACF,EAGD9E,EAAQ,SAAW,eAClB4B,EAAAA,IAAC,SAAA,CACC,QAAS,IAAMsC,EAAWlE,EAAQ,GAAG,EACrC,UAAU,8EACV,MAAM,mBAEN,SAAA4B,EAAAA,IAACmD,GAAA,CAAO,UAAU,SAAA,CAAU,CAAA,CAAA,CAC9B,CAAA,CAEJ,CAAA,CAAA,CAEJ,CAAA,EAnGK/E,EAAQ,GAAA,CAqGhB,EACH,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CAAA,EAKH+D,EAAa,GACZnC,EAAAA,IAACC,EAAO,IAAP,CACC,QAAS,CAAE,QAAS,EAAG,EAAG,EAAA,EAC1B,QAAS,CAAE,QAAS,EAAG,EAAG,CAAA,EAC1B,WAAY,CAAE,MAAO,EAAA,EACrB,UAAU,2BAEV,SAAAF,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACb,SAAA,CAAAC,EAAAA,IAAC,SAAA,CACC,QAAS,IAAM2B,EAAe,KAAK,IAAI,EAAGD,EAAc,CAAC,CAAC,EAC1D,SAAUA,IAAgB,EAC1B,UAAU,yGAEV,SAAA1B,EAAAA,IAACoD,GAAA,CAAY,UAAU,SAAA,CAAU,CAAA,CAAA,EAGnCrD,EAAAA,KAAC,OAAA,CAAK,UAAU,kCAAkC,SAAA,CAAA,UACxC2B,EAAY,OAAKS,CAAA,EAC3B,EAEAnC,EAAAA,IAAC,SAAA,CACC,QAAS,IAAM2B,EAAe,KAAK,IAAIQ,EAAYT,EAAc,CAAC,CAAC,EACnE,SAAUA,IAAgBS,EAC1B,UAAU,yGAEV,SAAAnC,EAAAA,IAACqD,GAAA,CAAa,UAAU,SAAA,CAAU,CAAA,CAAA,CACpC,CAAA,CACF,CAAA,CAAA,CACF,EAEJ,EAGArD,EAAAA,IAACsD,EAAA,CACC,OAAQpC,EACR,QAAS,IAAMC,EAAmB,EAAK,EACvC,UAAW,IAAM,CACfU,EAAA,EACAV,EAAmB,EAAK,CAC1B,CAAA,CAAA,EAGFnB,EAAAA,IAAChC,GAAA,CACC,OAAQ,CAAC,CAACoD,EACV,QAAS,IAAMC,EAAkB,IAAI,EACrC,UAAW,IAAM,CACfQ,EAAA,EACAR,EAAkB,IAAI,CACxB,EACA,QAASD,CAAA,CAAA,CACX,EACF,CAEJ"}